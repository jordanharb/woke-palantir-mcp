-- WARNING: This schema is for context only and is not meant to be run.
-- Table order and constraints may not be valid for execution.

CREATE TABLE public.bill_amendments (
  amendment_id integer NOT NULL DEFAULT nextval('bill_amendments_amendment_id_seq'::regclass),
  bill_id integer NOT NULL,
  document_id integer,
  amendment_number character varying,
  amendment_type character varying,
  sponsor_name character varying,
  sponsor_legislator_id integer,
  status character varying,
  proposed_date date,
  action_date date,
  committee_id integer,
  floor_vote_id integer,
  changes_summary text,
  sections_affected jsonb,
  created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
  updated_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
  CONSTRAINT bill_amendments_pkey PRIMARY KEY (amendment_id),
  CONSTRAINT bill_amendments_bill_id_fkey FOREIGN KEY (bill_id) REFERENCES public.bills(bill_id),
  CONSTRAINT bill_amendments_committee_id_fkey FOREIGN KEY (committee_id) REFERENCES public.committees(committee_id),
  CONSTRAINT bill_amendments_document_id_fkey FOREIGN KEY (document_id) REFERENCES public.bill_documents(document_id),
  CONSTRAINT bill_amendments_sponsor_legislator_id_fkey FOREIGN KEY (sponsor_legislator_id) REFERENCES public.legislators(legislator_id)
);
CREATE TABLE public.bill_documents (
  document_id integer NOT NULL DEFAULT nextval('bill_documents_document_id_seq'::regclass),
  bill_id integer NOT NULL,
  azleg_document_id integer UNIQUE,
  document_type character varying NOT NULL,
  document_group character varying,
  document_name character varying,
  version_number integer DEFAULT 1,
  html_content text,
  pdf_content bytea,
  plain_text text,
  word_count integer,
  page_count integer,
  original_pdf_url text,
  original_html_url text,
  original_word_url text,
  download_status character varying DEFAULT 'pending'::character varying,
  download_date timestamp without time zone,
  last_modified timestamp without time zone,
  extraction_date timestamp without time zone,
  extraction_method character varying,
  ai_summary text,
  ai_key_provisions jsonb,
  ai_fiscal_impact text,
  ai_analysis_date timestamp without time zone,
  created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
  updated_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
  CONSTRAINT bill_documents_pkey PRIMARY KEY (document_id),
  CONSTRAINT bill_documents_bill_id_fkey FOREIGN KEY (bill_id) REFERENCES public.bills(bill_id)
);
CREATE TABLE public.bill_embeddings (
  id bigint NOT NULL DEFAULT nextval('bill_embeddings_id_seq'::regclass),
  bill_id bigint NOT NULL,
  kind text NOT NULL CHECK (kind = ANY (ARRAY['summary'::text, 'chunk'::text])),
  chunk_index integer,
  content text NOT NULL,
  embedding USER-DEFINED,
  session_id integer,
  bill_number text,
  created_at timestamp with time zone DEFAULT now(),
  updated_at timestamp with time zone DEFAULT now(),
  CONSTRAINT bill_embeddings_pkey PRIMARY KEY (id)
);
CREATE TABLE public.bill_sections (
  section_id integer NOT NULL DEFAULT nextval('bill_sections_section_id_seq'::regclass),
  document_id integer NOT NULL,
  bill_id integer NOT NULL,
  section_number character varying,
  section_title character varying,
  section_type character varying,
  section_text text,
  statutes_affected jsonb,
  sequence_order integer,
  page_number integer,
  created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
  CONSTRAINT bill_sections_pkey PRIMARY KEY (section_id),
  CONSTRAINT bill_sections_bill_id_fkey FOREIGN KEY (bill_id) REFERENCES public.bills(bill_id),
  CONSTRAINT bill_sections_document_id_fkey FOREIGN KEY (document_id) REFERENCES public.bill_documents(document_id)
);
CREATE TABLE public.bill_sponsors (
  id integer NOT NULL DEFAULT nextval('bill_sponsors_id_seq'::regclass),
  bill_id integer NOT NULL,
  legislator_id integer NOT NULL,
  sponsor_type character varying,
  display_order integer,
  created_at timestamp with time zone DEFAULT now(),
  CONSTRAINT bill_sponsors_pkey PRIMARY KEY (id),
  CONSTRAINT bill_sponsors_bill_id_fkey FOREIGN KEY (bill_id) REFERENCES public.bills(bill_id),
  CONSTRAINT bill_sponsors_legislator_id_fkey FOREIGN KEY (legislator_id) REFERENCES public.legislators(legislator_id)
);
CREATE TABLE public.bill_summaries (
  summary_id integer NOT NULL DEFAULT nextval('bill_summaries_summary_id_seq'::regclass),
  bill_id integer NOT NULL,
  summary_type character varying NOT NULL,
  summary_source character varying,
  summary_text text NOT NULL,
  key_points jsonb,
  author character varying,
  publish_date date,
  created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
  updated_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
  CONSTRAINT bill_summaries_pkey PRIMARY KEY (summary_id),
  CONSTRAINT bill_summaries_bill_id_fkey FOREIGN KEY (bill_id) REFERENCES public.bills(bill_id)
);
CREATE TABLE public.bills (
  bill_id integer NOT NULL,
  session_id integer NOT NULL,
  bill_number character varying NOT NULL,
  short_title text,
  description text,
  now_title text,
  date_introduced date,
  bill_type character varying,
  primary_sponsor_name character varying,
  governor_action character varying,
  governor_action_date date,
  chapter_number character varying,
  final_disposition character varying,
  emergency boolean DEFAULT false,
  house_1st_read date,
  house_2nd_read date,
  senate_1st_read date,
  senate_2nd_read date,
  last_modified timestamp with time zone,
  created_at timestamp with time zone DEFAULT now(),
  updated_at timestamp with time zone DEFAULT now(),
  bill_text text,
  bill_summary text,
  summary_doc_id bigint,
  full_doc_id bigint,
  summary_title text,
  full_doc_type text,
  embedding_summary USER-DEFINED,
  embedding_full USER-DEFINED,
  embeddings_updated_at timestamp with time zone,
  CONSTRAINT bills_pkey PRIMARY KEY (bill_id),
  CONSTRAINT bills_session_id_fkey FOREIGN KEY (session_id) REFERENCES public.sessions(session_id)
);
CREATE TABLE public.cf_donations (
  donation_id integer NOT NULL DEFAULT nextval('cf_donations_donation_id_seq'::regclass),
  report_id integer,
  entity_id integer,
  record_id integer,
  donor_name character varying,
  donor_addr text,
  donor_city character varying,
  donor_state character varying,
  donor_zip character varying,
  donor_occupation character varying,
  donor_employer character varying,
  donation_date date,
  donation_amt numeric,
  donation_type character varying,
  cycle_to_date_amt numeric,
  page_num integer,
  page_type character varying,
  meta_segment_name character varying,
  meta_file_name character varying,
  donor_person_id integer,
  is_pac boolean DEFAULT false,
  is_corporate boolean DEFAULT false,
  import_date timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
  donor_full_address text,
  CONSTRAINT cf_donations_pkey PRIMARY KEY (donation_id),
  CONSTRAINT cf_donations_entity_id_fkey FOREIGN KEY (entity_id) REFERENCES public.cf_entities(entity_id),
  CONSTRAINT cf_donations_record_id_fkey FOREIGN KEY (record_id) REFERENCES public.cf_entity_records(record_id),
  CONSTRAINT cf_donations_report_id_fkey FOREIGN KEY (report_id) REFERENCES public.cf_reports(report_id)
);
CREATE TABLE public.cf_entities (
  entity_id integer NOT NULL,
  entity_url character varying,
  primary_committee_name character varying,
  primary_candidate_name character varying,
  total_records integer DEFAULT 0,
  earliest_activity date,
  latest_activity date,
  total_income_all_records numeric DEFAULT 0,
  total_expense_all_records numeric DEFAULT 0,
  max_cash_balance numeric DEFAULT 0,
  created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
  last_updated timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
  CONSTRAINT cf_entities_pkey PRIMARY KEY (entity_id)
);
CREATE TABLE public.cf_entity_records (
  record_id integer NOT NULL DEFAULT nextval('cf_entity_records_record_id_seq'::regclass),
  entity_id integer,
  entity_name character varying,
  entity_first_name character varying,
  committee_name character varying,
  entity_type character varying,
  office_name character varying,
  office_id integer,
  office_type_id integer,
  party_name character varying,
  party_id integer,
  cash_balance numeric DEFAULT 0,
  income numeric DEFAULT 0,
  expense numeric DEFAULT 0,
  ie_support numeric DEFAULT 0,
  ie_opposition numeric DEFAULT 0,
  bme_for numeric DEFAULT 0,
  bme_against numeric DEFAULT 0,
  committee_status character varying,
  registration_date date,
  termination_date date,
  committee_address text,
  mailing_address text,
  phone character varying,
  email character varying,
  chairman character varying,
  treasurer character varying,
  candidate character varying,
  designee character varying,
  is_primary_record boolean DEFAULT false,
  record_source character varying,
  record_date date,
  created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
  CONSTRAINT cf_entity_records_pkey PRIMARY KEY (record_id),
  CONSTRAINT cf_entity_records_entity_id_fkey FOREIGN KEY (entity_id) REFERENCES public.cf_entities(entity_id)
);
CREATE TABLE public.cf_entity_types (
  entity_type_id integer NOT NULL,
  entity_type_name character varying,
  entity_category character varying,
  created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
  CONSTRAINT cf_entity_types_pkey PRIMARY KEY (entity_type_id)
);
CREATE TABLE public.cf_report_pdfs (
  pdf_id integer NOT NULL DEFAULT nextval('cf_report_pdfs_pdf_id_seq'::regclass),
  entity_id integer,
  record_id integer,
  committee_report_id integer UNIQUE,
  report_name character varying,
  pdf_url text NOT NULL,
  filing_date date,
  filing_period_end_date date,
  cycle_year integer,
  report_status character varying,
  fines_due numeric,
  local_csv_path character varying,
  csv_converted boolean DEFAULT false,
  conversion_date timestamp without time zone,
  CONSTRAINT cf_report_pdfs_pkey PRIMARY KEY (pdf_id),
  CONSTRAINT cf_report_pdfs_entity_id_fkey FOREIGN KEY (entity_id) REFERENCES public.cf_entities(entity_id),
  CONSTRAINT cf_report_pdfs_record_id_fkey FOREIGN KEY (record_id) REFERENCES public.cf_entity_records(record_id)
);
CREATE TABLE public.cf_reports (
  report_id integer NOT NULL DEFAULT nextval('cf_reports_report_id_seq'::regclass),
  pdf_id integer,
  entity_id integer,
  record_id integer,
  rpt_title character varying,
  rpt_name character varying,
  rpt_cycle integer,
  rpt_file_date date,
  rpt_period character varying,
  org_name character varying,
  org_email character varying,
  org_phone character varying,
  org_address text,
  org_treasurer character varying,
  org_jurisdiction character varying,
  total_donations numeric,
  total_expenditures numeric,
  donation_count integer,
  processed_date timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
  total_personal_contributions numeric DEFAULT 0,
  total_individual_contributions numeric DEFAULT 0,
  total_committee_contributions numeric DEFAULT 0,
  total_business_contributions numeric DEFAULT 0,
  total_small_contributions numeric DEFAULT 0,
  total_ccec_funding numeric DEFAULT 0,
  total_qualifying_contributions numeric DEFAULT 0,
  total_loans_received numeric DEFAULT 0,
  total_other_receipts numeric DEFAULT 0,
  total_transfers_in numeric DEFAULT 0,
  total_cash_surplus numeric DEFAULT 0,
  total_operating_expenses numeric DEFAULT 0,
  total_independent_expenditures numeric DEFAULT 0,
  total_contributions_made numeric DEFAULT 0,
  total_small_expenses numeric DEFAULT 0,
  total_transfers_out numeric DEFAULT 0,
  total_loans_made numeric DEFAULT 0,
  total_surplus_disposal numeric DEFAULT 0,
  total_bill_payments numeric DEFAULT 0,
  total_income numeric DEFAULT 0,
  cash_balance_beginning numeric DEFAULT 0,
  cash_balance_ending numeric DEFAULT 0,
  report_type character varying,
  is_amended boolean DEFAULT false,
  has_activity boolean DEFAULT true,
  CONSTRAINT cf_reports_pkey PRIMARY KEY (report_id),
  CONSTRAINT cf_reports_entity_id_fkey FOREIGN KEY (entity_id) REFERENCES public.cf_entities(entity_id),
  CONSTRAINT cf_reports_pdf_id_fkey FOREIGN KEY (pdf_id) REFERENCES public.cf_report_pdfs(pdf_id),
  CONSTRAINT cf_reports_record_id_fkey FOREIGN KEY (record_id) REFERENCES public.cf_entity_records(record_id)
);
CREATE TABLE public.cf_transaction_entities (
  entity_id integer NOT NULL,
  entity_name character varying,
  first_name character varying,
  middle_name character varying,
  last_name character varying,
  entity_type_id integer,
  entity_type_description character varying,
  group_number integer,
  group_id integer,
  total_contributions numeric DEFAULT 0,
  total_expenditures numeric DEFAULT 0,
  transaction_count integer DEFAULT 0,
  unique_committees_count integer DEFAULT 0,
  first_transaction_date date,
  last_transaction_date date,
  created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
  last_updated timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
  embedding USER-DEFINED,
  CONSTRAINT cf_transaction_entities_pkey PRIMARY KEY (entity_id)
);
CREATE TABLE public.cf_transaction_groups (
  group_number integer NOT NULL,
  group_name character varying,
  group_color character varying,
  group_category character varying,
  created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
  CONSTRAINT cf_transaction_groups_pkey PRIMARY KEY (group_number)
);
CREATE TABLE public.cf_transaction_processing (
  entity_id integer NOT NULL,
  total_transactions integer DEFAULT 0,
  pages_processed integer DEFAULT 0,
  last_page_processed integer DEFAULT 0,
  processing_status character varying DEFAULT 'pending'::character varying,
  last_processed_at timestamp without time zone,
  next_process_after timestamp without time zone,
  error_message text,
  retry_count integer DEFAULT 0,
  created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
  last_updated timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
  CONSTRAINT cf_transaction_processing_pkey PRIMARY KEY (entity_id),
  CONSTRAINT cf_transaction_processing_entity_id_fkey FOREIGN KEY (entity_id) REFERENCES public.cf_entities(entity_id)
);
CREATE TABLE public.cf_transaction_types (
  transaction_type_id integer NOT NULL,
  transaction_type_name character varying NOT NULL,
  transaction_disposition_id integer,
  created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
  CONSTRAINT cf_transaction_types_pkey PRIMARY KEY (transaction_type_id)
);
CREATE TABLE public.cf_transactions (
  public_transaction_id bigint NOT NULL,
  transaction_id bigint NOT NULL,
  entity_id integer,
  transaction_entity_id integer,
  committee_id integer,
  committee_unique_id integer,
  committee_name character varying,
  transaction_date date,
  transaction_date_timestamp timestamp without time zone,
  transaction_date_year integer,
  transaction_date_year_month date,
  transaction_type_id integer,
  transaction_type character varying,
  transaction_type_disposition_id integer,
  amount numeric,
  transaction_name_id integer,
  transaction_name_group_id integer,
  transaction_entity_type_id integer,
  transaction_first_name character varying,
  transaction_middle_name character varying,
  transaction_last_name character varying,
  received_from_or_paid_to text,
  transaction_occupation character varying,
  transaction_employer character varying,
  transaction_city character varying,
  transaction_state character varying,
  transaction_zip_code character varying,
  entity_type_id integer,
  entity_description character varying,
  transaction_group_number integer,
  transaction_group_name character varying,
  transaction_group_color character varying,
  committee_group_number integer,
  committee_group_name character varying,
  committee_group_color character varying,
  subject_committee_id integer,
  subject_committee_name character varying,
  subject_committee_name_id integer,
  subject_group_number integer,
  is_for_benefit boolean,
  benefited_opposed character varying,
  candidate_cycle_id integer,
  candidate_office_type_id integer,
  candidate_office_id integer,
  candidate_party_id integer,
  candidate_first_name character varying,
  candidate_middle_name character varying,
  candidate_last_name character varying,
  ballot_measure_id integer,
  ballot_measure_number character varying,
  jurisdiction_id integer DEFAULT 0,
  jurisdiction_name character varying DEFAULT 'Arizona Secretary of State'::character varying,
  report_id integer,
  memo text,
  created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
  last_updated timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
  embedding USER-DEFINED,
  CONSTRAINT cf_transactions_pkey PRIMARY KEY (public_transaction_id),
  CONSTRAINT cf_transactions_entity_id_fkey FOREIGN KEY (entity_id) REFERENCES public.cf_entities(entity_id),
  CONSTRAINT cf_transactions_transaction_entity_id_fkey FOREIGN KEY (transaction_entity_id) REFERENCES public.cf_transaction_entities(entity_id)
);
CREATE TABLE public.committees (
  committee_id integer NOT NULL,
  committee_name character varying NOT NULL,
  committee_short_name character varying,
  committee_body character varying,
  committee_type character varying,
  is_subcommittee boolean DEFAULT false,
  is_active boolean DEFAULT true,
  created_at timestamp with time zone DEFAULT now(),
  updated_at timestamp with time zone DEFAULT now(),
  CONSTRAINT committees_pkey PRIMARY KEY (committee_id)
);
CREATE TABLE public.cron_logs (
  id bigint NOT NULL DEFAULT nextval('cron_logs_id_seq'::regclass),
  job_name text NOT NULL,
  status text NOT NULL CHECK (status = ANY (ARRAY['success'::text, 'error'::text])),
  response text,
  created_at timestamp with time zone DEFAULT now(),
  CONSTRAINT cron_logs_pkey PRIMARY KEY (id)
);
CREATE TABLE public.document_processing_queue (
  queue_id integer NOT NULL DEFAULT nextval('document_processing_queue_queue_id_seq'::regclass),
  bill_id integer NOT NULL,
  document_type character varying,
  task_type character varying NOT NULL,
  priority integer DEFAULT 5,
  source_url text,
  status character varying DEFAULT 'pending'::character varying,
  attempts integer DEFAULT 0,
  max_attempts integer DEFAULT 3,
  queued_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
  started_at timestamp without time zone,
  completed_at timestamp without time zone,
  last_error text,
  last_error_at timestamp without time zone,
  result_document_id integer,
  created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
  updated_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
  CONSTRAINT document_processing_queue_pkey PRIMARY KEY (queue_id),
  CONSTRAINT document_processing_queue_bill_id_fkey FOREIGN KEY (bill_id) REFERENCES public.bills(bill_id),
  CONSTRAINT document_processing_queue_result_document_id_fkey FOREIGN KEY (result_document_id) REFERENCES public.bill_documents(document_id)
);
CREATE TABLE public.donor_embeddings (
  id bigint NOT NULL DEFAULT nextval('donor_embeddings_id_seq'::regclass),
  transaction_entity_id bigint NOT NULL UNIQUE,
  content text NOT NULL,
  embedding USER-DEFINED,
  created_at timestamp with time zone DEFAULT now(),
  updated_at timestamp with time zone DEFAULT now(),
  CONSTRAINT donor_embeddings_pkey PRIMARY KEY (id)
);
CREATE TABLE public.embed_jobs (
  id bigint NOT NULL DEFAULT nextval('embed_jobs_id_seq'::regclass),
  domain text NOT NULL CHECK (domain = ANY (ARRAY['bill'::text, 'rts'::text, 'donor'::text])),
  source_id bigint NOT NULL,
  status text NOT NULL DEFAULT 'queued'::text CHECK (status = ANY (ARRAY['queued'::text, 'processing'::text, 'done'::text, 'error'::text])),
  error text,
  created_at timestamp with time zone DEFAULT now(),
  updated_at timestamp with time zone DEFAULT now(),
  CONSTRAINT embed_jobs_pkey PRIMARY KEY (id)
);
CREATE TABLE public.legislators (
  legislator_id integer NOT NULL,
  full_name character varying,
  member_topper_name character varying,
  party character varying,
  body character varying,
  district integer,
  email character varying,
  phone character varying,
  is_active boolean DEFAULT true,
  first_seen_session integer,
  last_seen_session integer,
  created_at timestamp with time zone DEFAULT now(),
  updated_at timestamp with time zone DEFAULT now(),
  CONSTRAINT legislators_pkey PRIMARY KEY (legislator_id)
);
CREATE TABLE public.rs_analysis_phase1_reports (
  phase1_report_id bigint NOT NULL DEFAULT nextval('rs_analysis_phase1_reports_phase1_report_id_seq'::regclass),
  person_id bigint NOT NULL,
  session_id integer,
  session_ids ARRAY DEFAULT '{}'::integer[],
  is_combined boolean DEFAULT false,
  custom_instructions text,
  phase1_data jsonb NOT NULL,
  summary_stats jsonb,
  bill_ids ARRAY DEFAULT '{}'::integer[],
  donation_ids ARRAY DEFAULT '{}'::text[],
  created_at timestamp with time zone NOT NULL DEFAULT now(),
  updated_at timestamp with time zone NOT NULL DEFAULT now(),
  CONSTRAINT rs_analysis_phase1_reports_pkey PRIMARY KEY (phase1_report_id),
  CONSTRAINT rs_analysis_phase1_reports_person_id_fkey FOREIGN KEY (person_id) REFERENCES public.rs_people(person_id),
  CONSTRAINT rs_analysis_phase1_reports_session_id_fkey FOREIGN KEY (session_id) REFERENCES public.sessions(session_id)
);
CREATE TABLE public.rs_analysis_reports (
  report_id bigint NOT NULL DEFAULT nextval('rs_analysis_reports_report_id_seq'::regclass),
  person_id bigint NOT NULL,
  session_id integer,
  is_combined boolean DEFAULT false,
  custom_instructions text,
  report_data jsonb NOT NULL,
  bill_ids ARRAY DEFAULT '{}'::integer[],
  analysis_duration_ms integer,
  created_at timestamp with time zone DEFAULT CURRENT_TIMESTAMP,
  donation_ids ARRAY DEFAULT '{}'::text[],
  phase1_report_id bigint,
  CONSTRAINT rs_analysis_reports_pkey PRIMARY KEY (report_id),
  CONSTRAINT rs_analysis_reports_person_id_fkey FOREIGN KEY (person_id) REFERENCES public.rs_people(person_id),
  CONSTRAINT rs_analysis_reports_phase1_report_id_fkey FOREIGN KEY (phase1_report_id) REFERENCES public.rs_analysis_phase1_reports(phase1_report_id),
  CONSTRAINT rs_analysis_reports_session_id_fkey FOREIGN KEY (session_id) REFERENCES public.sessions(session_id)
);
CREATE TABLE public.rs_name_overrides (
  raw_name text NOT NULL,
  forced_key text NOT NULL,
  note text,
  CONSTRAINT rs_name_overrides_pkey PRIMARY KEY (raw_name)
);
CREATE TABLE public.rs_people (
  person_id bigint NOT NULL DEFAULT nextval('rs_people_person_id_seq'::regclass),
  display_name text,
  created_at timestamp with time zone DEFAULT now(),
  name_key text,
  CONSTRAINT rs_people_pkey PRIMARY KEY (person_id)
);
CREATE TABLE public.rs_person_cf_entities (
  person_id bigint NOT NULL,
  entity_id integer NOT NULL,
  CONSTRAINT rs_person_cf_entities_pkey PRIMARY KEY (entity_id, person_id),
  CONSTRAINT rs_person_cf_entities_entity_id_fkey FOREIGN KEY (entity_id) REFERENCES public.cf_entities(entity_id),
  CONSTRAINT rs_person_cf_entities_person_id_fkey FOREIGN KEY (person_id) REFERENCES public.rs_people(person_id)
);
CREATE TABLE public.rs_person_leg_sessions (
  person_id bigint NOT NULL,
  legislator_id integer NOT NULL,
  session_id integer NOT NULL,
  created_at timestamp with time zone DEFAULT CURRENT_TIMESTAMP,
  CONSTRAINT rs_person_leg_sessions_pkey PRIMARY KEY (person_id, session_id, legislator_id),
  CONSTRAINT rs_person_leg_sessions_legislator_id_fkey FOREIGN KEY (legislator_id) REFERENCES public.legislators(legislator_id),
  CONSTRAINT rs_person_leg_sessions_person_id_fkey FOREIGN KEY (person_id) REFERENCES public.rs_people(person_id),
  CONSTRAINT rs_person_leg_sessions_session_id_fkey FOREIGN KEY (session_id) REFERENCES public.sessions(session_id)
);
CREATE TABLE public.rs_person_legislators (
  person_id bigint NOT NULL,
  legislator_id integer NOT NULL,
  CONSTRAINT rs_person_legislators_pkey PRIMARY KEY (person_id, legislator_id),
  CONSTRAINT rs_person_legislators_legislator_id_fkey FOREIGN KEY (legislator_id) REFERENCES public.legislators(legislator_id),
  CONSTRAINT rs_person_legislators_person_id_fkey FOREIGN KEY (person_id) REFERENCES public.rs_people(person_id)
);
CREATE TABLE public.rs_person_tx_entities (
  person_id bigint NOT NULL,
  transaction_entity_id integer NOT NULL,
  CONSTRAINT rs_person_tx_entities_pkey PRIMARY KEY (person_id, transaction_entity_id),
  CONSTRAINT rs_person_tx_entities_person_id_fkey FOREIGN KEY (person_id) REFERENCES public.rs_people(person_id)
);
CREATE TABLE public.rts_embeddings (
  id bigint NOT NULL DEFAULT nextval('rts_embeddings_id_seq'::regclass),
  rts_id bigint NOT NULL UNIQUE,
  content text NOT NULL,
  embedding USER-DEFINED,
  bill_id bigint,
  position text,
  created_at timestamp with time zone DEFAULT now(),
  updated_at timestamp with time zone DEFAULT now(),
  CONSTRAINT rts_embeddings_pkey PRIMARY KEY (id)
);
CREATE TABLE public.rts_positions (
  position_id integer NOT NULL DEFAULT nextval('rts_positions_position_id_seq'::regclass),
  bill_id integer NOT NULL,
  bill_position_id integer UNIQUE,
  entity_name character varying,
  representing character varying,
  position character varying,
  user_id integer,
  submitted_date timestamp with time zone,
  created_at timestamp with time zone DEFAULT now(),
  embedding USER-DEFINED,
  CONSTRAINT rts_positions_pkey PRIMARY KEY (position_id),
  CONSTRAINT rts_positions_bill_id_fkey FOREIGN KEY (bill_id) REFERENCES public.bills(bill_id)
);
CREATE TABLE public.sessions (
  session_id integer NOT NULL,
  session_name character varying,
  legislature_number integer,
  session_type character varying,
  year integer,
  start_date date,
  end_date date,
  is_active boolean DEFAULT false,
  created_at timestamp with time zone DEFAULT now(),
  updated_at timestamp with time zone DEFAULT now(),
  CONSTRAINT sessions_pkey PRIMARY KEY (session_id)
);
CREATE TABLE public.votes (
  vote_id integer NOT NULL DEFAULT nextval('votes_vote_id_seq'::regclass),
  bill_id integer NOT NULL,
  legislator_id integer,
  committee_id integer,
  vote character varying NOT NULL,
  venue character varying,
  venue_type character varying,
  motion_text text,
  vote_date date,
  report_date timestamp with time zone,
  created_at timestamp with time zone DEFAULT now(),
  CONSTRAINT votes_pkey PRIMARY KEY (vote_id),
  CONSTRAINT votes_bill_id_fkey FOREIGN KEY (bill_id) REFERENCES public.bills(bill_id),
  CONSTRAINT votes_committee_id_fkey FOREIGN KEY (committee_id) REFERENCES public.committees(committee_id),
  CONSTRAINT votes_legislator_id_fkey FOREIGN KEY (legislator_id) REFERENCES public.legislators(legislator_id)
);